(function(t){function e(e){for(var s,o,r=e[0],l=e[1],c=e[2],d=0,h=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],s=!0,r=1;r<i.length;r++){var l=i[r];0!==n[l]&&(s=!1)}s&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},n={job:0},a=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;a.push([1,"chunk-vendors","chunk-common"]),i()})({"085e":function(t,e,i){},1:function(t,e,i){t.exports=i("3936")},2:function(t,e){},3936:function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var s=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("Nav",{attrs:{showHome:!0,cognito:t.cognito},on:{credits:t.onCredits}}),i("Progress",{attrs:{cognito:t.cognito,jobid:t.jobid},on:{finished:t.onFinished}}),i("Player",{attrs:{urls:t.urls,jobid:t.jobid,credits:t.credits,cognito:t.cognito}}),i("Footer")],1)},a=[],o=(i("4160"),i("c975"),i("ac1f"),i("1276"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticClass:"container"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-8 mx-auto"},[i("h4",[t._v(t._s(t.title))]),i("p",{style:{visibility:"error"!==this.status?"visible":"hidden"}},[t._v(" This should only take a while... ")]),i("div",{staticClass:"progress",staticStyle:{height:"40px"}},[i("div",{class:t.barclass,staticStyle:{width:"100%"},attrs:{role:"progressbar"}},[i("span",{staticClass:"justify-content-center w-100"},[i("b",[t._v(t._s(t.displayedStatus))])])])])])])])}),r=[],l=(i("d3b7"),i("5fb0")),c={name:"Progress",props:["cognito","jobid"],data:function(){return{loggedin:this.cognito.isLoggedIn(),timer:null,status:"initiated",processingError:null,firstQuery:!0,filename:""}},computed:{showProgress:function(){return null!==this.jobid&&"finished"!==this.status&&"preview"!==this.status},showFilename:function(){return""!==this.filename&&null!==this.filename},title:function(){return"DeMixing"+(this.filename?' "'+this.filename+'"':"...")},displayedStatus:function(){return"error"===this.status?this.processingError:this.firstQuery?"":"initiated"===this.status?"In queue":"downloading"===this.status||"processing"===this.status||"refining"===this.status?"Processing":"converting"===this.status||"uploading"===this.status||"finalizing"===this.status?"Finalizing":this.status},barclass:function(){return"error"===this.status?"progress-bar bg-danger":"progress-bar progress-bar-striped progress-bar-animated"}},methods:{onFailure:function(t){clearInterval(this.timer),this.status="error",this.processingError=t},doFetch:function(t,e){var i=this;fetch(t,e).then((function(t){if(t.ok)return t.json();throw 401===t.status&&(i.cognito.isLoggedIn()||(window.location.href=i.cognito.geturl("login",null,null))),t.json()})).then((function(t){i.firstQuery=!1,i.status=t.status,i.filename=t.filename,"finished"!==t.status&&"preview"!==t.status||(clearInterval(i.timer),t.bass?i.$emit("finished",{vocal:t.vocal,bass:t.bass,drums:t.drums,other:t.other,title:t.filename,paid:t.paid,zipfile:t.zipfile,nopreview:t.nopreview}):i.$emit("finished",{vocal:t.vocal,instrumental:t.instrumental,title:t.filename,paid:t.paid,zipfile:t.zipfile,nopreview:t.nopreview})),"error"===t.status&&(t.reason&&t.reason.length>0?i.onFailure(t.reason):i.onFailure("Failed to process file. Please specify a valid audio file."))})).catch((function(t){var e="function"==typeof t.then;e?t.then((function(t){i.onFailure(t.errorMessage)})):i.onFailure("Network failure. Please try again later.")}))},fetchProgress:function(){var t="https://api."+l["b"]+"/getprogressua?jobid="+this.jobid,e={mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"}};this.cognito.isLoggedIn()?this.cognito.getToken(function(i){t="https://api."+l["b"]+"/getprogress?jobid="+this.jobid,e["headers"]["Authorization"]=i,this.doFetch(t,e)}.bind(this),function(){this.cognito.logout()}.bind(this)):this.doFetch(t,e)}},created:function(){this.timer=setInterval(this.fetchProgress,3e3),this.fetchProgress()},beforeDestroy:function(){clearInterval(this.timer)}},u=c,d=i("2877"),h=Object(d["a"])(u,o,r,!1,null,"dda5e282",null),p=h.exports,f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"container"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-8 mx-auto"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.show&&t.preview,expression:"show && preview"}],staticClass:"badge badge-warning title-label-badge"},[t._v("Preview")]),i("h4",[t._v(t._s(t.title))]),i("div",{staticClass:"text-center",staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[t.preview&&t.hasCredits?i("button",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"10px"},attrs:{disabled:t.processing},on:{click:t.buy}},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.hasCredits&&!t.processing,expression:"hasCredits && !processing"}]},[t._v("Buy with credit")]),t.processing?i("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e()]):t._e(),t.preview?t._e():i("a",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"10px"},attrs:{href:t.zipfile,download:"",type:"application/zip"}},[t._v(" Download ")]),i("a",{staticClass:"btn btn-dark",attrs:{href:"/"}},[t._v(" Try Another ")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.preview&&t.loaded&&!t.nopreview&&t.hasCredits,expression:"preview && loaded && !nopreview && hasCredits"}],staticClass:"alert alert-warning",attrs:{role:"alert"}},[t._v(" This is a preview of the song. Purchase with credits and download the full song. "),i("a",{attrs:{href:"/#faq",target:"_blank",rel:"noopener noreferrer"}},[t._v("What do I get?")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.preview&&t.loaded&&!t.nopreview&&!t.hasCredits,expression:"preview && loaded && !nopreview && !hasCredits"}],staticClass:"alert alert-warning",attrs:{role:"alert"}},[t._v(" This is a preview of the song. Purchase and download the full song using one of the "),i("a",{attrs:{href:"#pricing"}},[t._v("buying options")]),t._v(" below. "),i("a",{attrs:{href:"/#faq",target:"_blank",rel:"noopener noreferrer"}},[t._v("What do I get?")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.loaded&&!t.nopreview,expression:"!loaded && !nopreview"}],staticClass:"text-center",staticStyle:{"margin-top":"20px"}},[i("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}),t._v(" Loading player... ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.loaded&&t.nopreview,expression:"!loaded && nopreview"}],staticClass:"text-center",staticStyle:{"margin-top":"20px"}},[i("b",[t._v("Preview unavailable. Audio too short.")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.loaded,expression:"loaded"}],staticClass:"controls"},[i("div",{ref:"waveform",attrs:{id:"playlist"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.stem4,expression:"!stem4"}],staticClass:"text-center",staticStyle:{"margin-bottom":"10px"}},[i("button",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"10px"},on:{click:t.toggle}},[i("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],attrs:{icon:"play"}}),i("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{icon:"pause"}})],1),i("button",{class:t.vocalClass,staticStyle:{"margin-right":"10px"},on:{click:t.toggleVocal}},[i("font-awesome-icon",{attrs:{icon:"microphone-alt"}})],1),i("button",{class:t.instrumentalClass,staticStyle:{"margin-right":"10px"},on:{click:t.toggleInstrumental}},[i("font-awesome-icon",{attrs:{icon:"guitar"}})],1),i("button",{class:t.bothClass,staticStyle:{"margin-right":"10px"},on:{click:t.toggleBoth}},[i("font-awesome-icon",{attrs:{icon:"microphone-alt"}}),t._v(" + "),i("font-awesome-icon",{attrs:{icon:"guitar"}})],1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.stem4,expression:"stem4"}],staticClass:"text-center",staticStyle:{"margin-bottom":"10px"}},[i("button",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"10px"},on:{click:t.toggle}},[i("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],attrs:{icon:"play"}}),i("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{icon:"pause"}})],1),i("button",{class:t.vocalClass4,staticStyle:{"margin-right":"10px"},on:{click:t.toggleVocal4}},[i("font-awesome-icon",{attrs:{icon:"microphone-alt"}})],1),i("button",{class:t.bassClass4,staticStyle:{"margin-right":"10px"},on:{click:t.toggleBass4}},[i("font-awesome-icon",{attrs:{icon:"guitar"}})],1),i("button",{class:t.drumsClass4,staticStyle:{"margin-right":"10px"},on:{click:t.toggleDrums4}},[i("font-awesome-icon",{attrs:{icon:"drum"}})],1),i("button",{class:t.otherClass4,staticStyle:{"margin-right":"10px"},on:{click:t.toggleOther4}},[i("font-awesome-icon",{attrs:{icon:"music"}})],1)])])])]),i("Pricing",{directives:[{name:"show",rawName:"v-show",value:t.show&&t.preview&&!t.hasCredits,expression:"show && preview && !hasCredits"}],attrs:{jobid:t.jobid,cognito:t.cognito}})],1)},v=[],g=i("132e"),m=i("087a"),b={name:"Player",components:{Pricing:m["a"]},props:["urls","jobid","credits","cognito","sepconfig"],data:function(){return{playlist:null,loaded:!1,nopreview:!1,loadingRequested:!1,preview:!1,playing:!1,title:"",activeState:"instrumental",zipfile:null,hasCredits:!1,processing:!1,stem4:!1,vocalEnabled4:!1,bassEnabled4:!0,drumsEnabled4:!0,otherEnabled4:!0}},watch:{credits:function(t,e){null!==t&&t!==e&&(this.hasCredits=t>0)},urls:function(t,e){var i=this;null===t||t===e||this.loadingRequested||(this.title=t.title,this.preview=!t.paid,this.stem4=!1,t.bass&&(this.stem4=!0),t.nopreview?this.nopreview=!0:(this.zipfile=t.zipfile,this.loadingRequested=!0,t.instrumental?this.playlist.load([{src:t.vocal,name:"Vocal",muted:!0,customClass:"vocal",waveOutlineColor:"#f0f0f0"},{src:t.instrumental,name:"Instrumental",muted:!1,customClass:"instrumental",waveOutlineColor:"#f0f0f0"}]).then((function(){i.loaded=!0,i.activeState="instrumental";var t=i.playlist.getEventEmitter();t.on("finished",function(){this.playing=!1}.bind(i)),t.on("timeupdate",function(){this.playing||this.toggle()}.bind(i)),i.preview||t.emit("zoomout")})):this.playlist.load([{src:t.vocal,name:"Vocal",muted:!0,customClass:"vocal",waveOutlineColor:"#f0f0f0"},{src:t.bass,name:"Bass",muted:!1,customClass:"bass",waveOutlineColor:"#f0f0f0"},{src:t.drums,name:"Drums",muted:!1,customClass:"drums",waveOutlineColor:"#f0f0f0"},{src:t.other,name:"Other",muted:!1,customClass:"other",waveOutlineColor:"#f0f0f0"}]).then((function(){i.loaded=!0,i.vocalEnabled4=!1,i.bassEnabled4=!0,i.drumsEnabled4=!0,i.otherEnabled4=!0;var t=i.playlist.getEventEmitter();t.on("finished",function(){this.playing=!1}.bind(i)),t.on("timeupdate",function(){this.playing||this.toggle()}.bind(i)),i.preview||t.emit("zoomout")}))))}},methods:{onFailure:function(t){this.$toast.error(t,{position:"top",duration:5e3}),this.processing=!1},buy:function(){if(event.preventDefault(),this.hasCredits){var t=confirm("Use 1 credit?");t&&(this.processing=!0,this.cognito.getToken(function(t){var e=this,i="https://api."+l["b"]+"/purchase?jobid="+this.jobid,s={method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:t}};fetch(i,s).then((function(t){if(t.ok)return t.json();throw t.json()})).then((function(){var t=window.location.href.split("#");t[0].indexOf("?")>=0?window.location.href=t[0]+"&purchased=0":window.location.href=t[0]+"?purchased=0"})).catch((function(t){var i="function"==typeof t.then;i?t.then((function(t){e.onFailure(t.errorMessage)})):e.onFailure("Network failure. Please try again later.")}))}.bind(this),function(){this.cognito.logout()}.bind(this)))}},toggle:function(){if(null!==this.playlist){var t=this.playlist.getEventEmitter();this.playing?t.emit("pause"):t.emit("play"),this.playing=!this.playing}},toggleVocal:function(){if("instrumental"===this.activeState){var t=this.$el.querySelectorAll(".btn-mute");t[0].click(),t[1].click()}else if("both"===this.activeState){var e=this.$el.querySelectorAll(".btn-mute");e[1].click()}this.activeState="vocal"},toggleInstrumental:function(){if("vocal"===this.activeState){var t=this.$el.querySelectorAll(".btn-mute");t[0].click(),t[1].click()}else if("both"===this.activeState){var e=this.$el.querySelectorAll(".btn-mute");e[0].click()}this.activeState="instrumental"},toggleBoth:function(){if("vocal"===this.activeState){var t=this.$el.querySelectorAll(".btn-mute");t[1].click()}else if("instrumental"===this.activeState){var e=this.$el.querySelectorAll(".btn-mute");e[0].click()}this.activeState="both"},toggleVocal4:function(){var t=this.$el.querySelectorAll(".btn-mute");t[0].click(),this.vocalEnabled4=!this.vocalEnabled4},toggleBass4:function(){var t=this.$el.querySelectorAll(".btn-mute");t[1].click(),this.bassEnabled4=!this.bassEnabled4},toggleDrums4:function(){var t=this.$el.querySelectorAll(".btn-mute");t[2].click(),this.drumsEnabled4=!this.drumsEnabled4},toggleOther4:function(){var t=this.$el.querySelectorAll(".btn-mute");t[3].click(),this.otherEnabled4=!this.otherEnabled4}},computed:{show:function(){return null!==this.urls},vocalClass:function(){return"vocal"===this.activeState?"btn btn-dark":"btn btn-outline-dark"},instrumentalClass:function(){return"instrumental"===this.activeState?"btn btn-dark":"btn btn-outline-dark"},bothClass:function(){return"both"===this.activeState?"btn btn-dark":"btn btn-outline-dark"},vocalClass4:function(){return this.vocalEnabled4?"btn btn-dark":"btn btn-outline-dark"},bassClass4:function(){return this.bassEnabled4?"btn btn-dark":"btn btn-outline-dark"},drumsClass4:function(){return this.drumsEnabled4?"btn btn-dark":"btn btn-outline-dark"},otherClass4:function(){return this.otherEnabled4?"btn btn-dark":"btn btn-outline-dark"}},mounted:function(){this.playlist=g["init"]({samplesPerPixel:2500,zoomLevels:[2500,1e4],mono:!0,exclSolo:!0,timescale:!1,isAutomaticScroll:!0,waveHeight:64,container:this.$refs.waveform,state:"cursor",waveOutlineColor:"#E0EFF1",colors:{waveOutlineColor:"#E0EFF1",timeColor:"grey",fadeColor:"black"},controls:{show:!0,width:0}}),window.addEventListener("keypress",function(t){" "===String.fromCharCode(t.keyCode)&&this.toggle()}.bind(this))}},w=b,y=(i("b30b"),Object(d["a"])(w,f,v,!1,null,null,null)),C=y.exports,x=i("4d45"),k=i("f124"),S=i("53fb"),j=i("69d9");function E(){var t=window.location.href.split("#"),e=t[0].split("?");if(2==e.length){var i=e[1].split("&"),s={},n="";if(i.forEach((function(t){n=t.indexOf("="),s[t.substring(0,n)]=t.substring(n+1)})),void 0!==s["jobid"])return s["jobid"];if(void 0!==s["state"]){var a=Object(j["a"])(s["state"]);return a["jobid"]}return null}return null}var _={name:"app",components:{Nav:x["a"],Progress:p,Player:C,Footer:k["a"]},data:function(){return{cognito:null,jobid:null,urls:null,credits:0}},computed:{},created:function(){this.jobid=E(),this.cognito=new S["a"](!0),this.finished=!1},methods:{onFinished:function(t){this.urls=t},onCredits:function(t){this.credits=t.credits}}},P=_,O=Object(d["a"])(P,n,a,!1,null,null,null),F=O.exports,N=i("1e18"),$=(i("f9e3"),i("2dd8"),i("ecee")),A=i("c074"),q=i("f2d1"),z=i("ad3d"),I=i("b079"),T=i.n(I),D=(i("2fff"),i("dc21")),M=i("e594");s["default"].use(N["a"]),s["default"].config.productionTip=!1,$["c"].add(A["g"]),$["c"].add(A["f"]),$["c"].add(A["d"]),$["c"].add(A["c"]),$["c"].add(A["b"]),$["c"].add(A["e"]),$["c"].add(q["a"]),s["default"].component("font-awesome-icon",z["a"]),s["default"].use(T.a),D["a"]({dsn:"https://64d72f407d184a519a84658cf745eabb@o399199.ingest.sentry.io/5255957",integrations:[new M["a"]({Vue:s["default"],attachProps:!0})]}),new s["default"]({render:function(t){return t(F)}}).$mount("#app")},b30b:function(t,e,i){"use strict";var s=i("085e"),n=i.n(s);n.a}});
//# sourceMappingURL=job.40ef4c0d.js.map